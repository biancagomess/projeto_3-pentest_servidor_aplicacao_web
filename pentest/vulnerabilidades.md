<h1>Identificação de Vulnerabilidades</h1>

<h2> 1. Falha de Controle de Acesso</h2>


Foi possível acessar o arquivo ***robots.txt que continha a seguinte configuração:***

```
User-agent: *
Disallow: /ftp
```

Este arquivo indicava que o diretório /ftp estava configurado para não ser indexado por mecanismos de busca, mas não impedia o acesso direto.

Ao tentar acessar diretamente o diretório /ftp na URL, foi identificada uma falha de controle de acesso e uma configuração incorreta de segurança. Os arquivos disponíveis no diretório incluíam:

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/11a5be46d38c96910641b8999b2144b28ec25140/imagens/1-1-vulnerabilidade-robotstxt_ftp.png" width="50%">
  </div>
</div>

Esta situação demonstra um bypass de controle de acesso, permitindo o acesso a arquivos que deveriam estar protegidos.

### Impacto potencial

A exposição do diretório /ftp e dos arquivos nele contidos pode levar a várias implicações de segurança, incluindo:

Exposição de Dados Sensíveis: Acesso não autorizado a informações que deveriam estar restritas.
Vulnerabilidade de Configuração: Indica uma configuração inadequada de segurança que pode ser explorada por agentes maliciosos.
 

### Prevenção e correção:

- Desative a listagem de diretórios (directory listing) para todos os diretórios que não são públicos.
- **Restrinja o acesso ao diretório /ftp e exija autenticação forte para acessá-lo.
- Realizar o teste de controle de acesso e validar.
- **Implementar políticas de segurança mais robustas** para proteger informações sensíveis e evitar exposições acidentais.
- Implementar o princípio do privilégio mínimo.
- Verificar que o controle de acesso falhe de modo seguro. Não vazar informações sensíveis no exception.
- **Conscientizar os funcionários** sobre a importância de proteger documentos confidenciais e monitorar regularmente a conformidade com as políticas de segurança.
- **Implementação de Criptografia**: Utilize criptografia forte para proteger documentos confidenciais, especialmente quando estão em trânsito ou armazenados. Adicionando uma camada adicional de segurança, mesmo se os arquivos forem acessados de forma não autorizada.
- Logar os acessos.



<h2> 2. Falha de SQL Injection - Loggin com Admin</h2>

Ao acessar o menu de Login, foi possível explorar a vulnerabilidade de SQL Injection utilizando o seguinte payload:

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/11a5be46d38c96910641b8999b2144b28ec25140/imagens/sql-injection-admin.png" width="50%">
  </div>
</div>


```sql
admin’ or 1=1 — 
```

Este comando foi injetado no campo de entrada do login, permitindo que um usuário não autorizado acessasse a conta de administrador, listar todos os usuários cadastrados no sistema e apagar os comentários existentes na aplicação, conforme imagens abaixo:

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/bac8141d464c725b78a0630253a7e5072e930290/imagens/3.2-access-admin-see-all-users.png" width="50%">
  <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/bac8141d464c725b78a0630253a7e5072e930290/imagens/apagando-os-comentariospng.png" width="50%">
  </div>
</div>


## Impacto Potencial 
- Permite que um atacante obtenha acesso completo às funcionalidades administrativas da aplicação, comprometendo a integridade e a confidencialidade dos dados.
- O atacante pode acessar, modificar ou excluir dados sensíveis armazenados no sistema, incluindo informações pessoais dos usuários e dados críticos da aplicação.
- Com acesso administrativo, o atacante pode potencialmente modificar configurações críticas, instalar backdoors, e explorar outras vulnerabilidades na aplicação.


### Prevenção e Correção

É essencial implementar práticas de desenvolvimento seguro e configurar corretamente o sistema para evitar que dados maliciosos possam ser inseridos e explorados como comandos SQL.

- Sempre valide e filtre todas as entradas de dados recebidas do usuário antes de usá-las em consultas SQL. Isso inclui campos de formulário, parâmetros de URL, cookies, etc.
- Realizar a sanitização dos dados utilizando uma API segura, como por exemplo o **Utilização de Prepared Statements (Declarações Preparadas)**: para separar os dados dos comandos SQL, impedindo assim a execução maliciosa de código SQL inserido.
- **Não realizar concatenação de strings.**
- **Usar ORM (Object-Relational Mapping):** evitar diretamente o uso de SQL bruto, automatizando a geração de consultas SQL seguras e prevenindo vulnerabilidades de injeção.
- Usar listas positivas(parâmetros permitidos) para validar os parâmetros que estiver na lista.
- **Implementar Princípio do Menor Privilégio**: Configure permissões de banco de dados e acesso de usuário de forma que apenas os privilégios mínimos necessários para realizar operações sejam concedidos. Evite usar contas de usuário com privilégios de administrador para operações rotineiras.
- Escapar todas as entradas fornecidas pelo o usuário.
- Limitar os resultados do retorno da comunicação.


<h2>3. Falha de Autenticação - Senha fraca</h2>
Ao explorar a vulnerabilidade de SQL Injection para acessar a conta de administrador, foi possível interceptar a comunicação e obter um token Bearer utilizando a ferramenta Burp Suite, realizando a intercepação do token Bearer retornado após o login.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/sql-injection-burp-token.png" width="50%">
  </div>
</div>

O token foi decodificado de Base64 usando o Decoder do Burp Suite, revelando os dados do token e o hash da senha.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/sql-injection-password-hash.png" width="50%">
  </div>
</div>

O hash extraído do token foi salvo em um arquivo denominado hash_test.txt.
Utilizando a ferramenta John the Ripper para comparar o hash foi possível obter a senha do administrador: **admin123**

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/john-hash.png" width="50%">
  </div>
</div>

Com a senha obtida, foi realizado o login com as credenciais de administrador, confirmando a fraqueza da senha.

### Prevenção e Correção

- Implementar políticas de senha fortes com um mínimo de caracteres, usando uma combinação de caracteres especiais, letras maiúsculas, letras minúsculas. Pois senhas menores que 8 caracteres são consideradas fracas.
- Exigir MFA (usar Authenticator Microsoft ou Google)
- Verifique as listas de vazamentos de senha e bloqueio o usos de senhas já comprometidas.
- Implementar limite de tentativas de login, por exemplo após 3 tentativas falhas, bloquear por 10 minutos, ou melhor, implementar de forma exponencial, sobrando o tempo para novas tentativas.
- Auxiliar os usuários a criarem a senha forte.
- Armazenar senhas usando algorítimos de criptografia forte.
- Notificar os usuários caso haja alteração em algum fator de autenticação.
- Não usar tokens e sessão como parâmetros na URL ou em mensagens de erro.
- Implementar mecanismos de recuperação de senha de forma segura, evitar notificações push via SMS.
- Implementar autenticação por IP.
- Logar todos os acesso de forma segura e revisar todas as falhas.
- Usar autenticação sem senha como SSO Logon.
- Permitir o gerecimento de senhas pelo usuário.



