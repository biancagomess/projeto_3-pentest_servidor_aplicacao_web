<h1>Identificação de Vulnerabilidades</h1>

<h2> 1. Falha de Controle de Acesso</h2>


Foi possível acessar o arquivo ***robots.txt que continha a seguinte configuração:***

```
User-agent: *
Disallow: /ftp
```

Este arquivo indicava que o diretório /ftp estava configurado para não ser indexado por mecanismos de busca, mas não impedia o acesso direto.

Ao tentar acessar diretamente o diretório /ftp na URL, foi identificada uma falha de controle de acesso e uma configuração incorreta de segurança. 
Os arquivos disponíveis no diretório incluíam:

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/11a5be46d38c96910641b8999b2144b28ec25140/imagens/1-1-vulnerabilidade-robotstxt_ftp.png" width="50%">
  </div>
</div>

Esta situação demonstra um bypass de controle de acesso, permitindo o acesso a arquivos que deveriam estar protegidos, pois são arquivos sensíveis de backup, criptografia e configurações.

<h3>Impacto potencial</h3>

A exposição do diretório /ftp e dos arquivos nele contidos pode levar a várias implicações de segurança, incluindo:

- Exposição de Dados Sensíveis - acesso não autorizado a informações que deveriam estar restritas.
- Indica uma configuração inadequada de segurança que pode ser explorada por agentes maliciosos.
 
<h3>Prevenção e correção:</h3>

- Desative a listagem de diretórios (directory listing) para todos os diretórios que não são públicos.
- **Restrinja o acesso ao diretório /ftp e exija autenticação forte para acessá-lo.
- Realizar o teste de controle de acesso e validar.
- **Implementar políticas de segurança mais robustas** para proteger informações sensíveis e evitar exposições acidentais.
- Implementar o princípio do privilégio mínimo.
- Verificar que o controle de acesso falhe de modo seguro. Não vazar informações sensíveis no exception.
- **Conscientizar os funcionários** sobre a importância de proteger documentos confidenciais e monitorar regularmente a conformidade com as políticas de segurança.
- **Implementação de Criptografia**: Utilize criptografia forte para proteger documentos confidenciais, especialmente quando estão em trânsito ou armazenados. Adicionando uma camada adicional de segurança, mesmo se os arquivos forem acessados de forma não autorizada.
- Logar os acessos.

<h2> 2. Falha de SQL Injection - Loggin com Admin</h2>

Ao acessar o menu de Login, foi possível explorar a vulnerabilidade de SQL Injection utilizando o seguinte payload:

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/11a5be46d38c96910641b8999b2144b28ec25140/imagens/sql-injection-admin.png" width="50%">
  </div>
</div>


```
admin’ or 1=1 — 
```

Este comando foi injetado no campo de entrada do login, permitindo que um usuário não autorizado acessasse a conta de administrador, listar todos os usuários cadastrados no sistema e apagar os comentários existentes na aplicação, conforme imagens abaixo:

<div align="center">
   <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/bac8141d464c725b78a0630253a7e5072e930290/imagens/3.2-access-admin-see-all-users.png" style="display: inline-block; width: 50%; margin-right: 10px;">
  <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/bac8141d464c725b78a0630253a7e5072e930290/imagens/apagando-os-comentariospng.png" style="display: inline-block; width: 40%; margin-right: 10px;">
  </div>
</div>


<h3>Impacto potencial</h3>

- Permite que um atacante obtenha acesso completo às funcionalidades administrativas da aplicação, comprometendo a integridade e a confidencialidade dos dados.
- O atacante pode acessar, modificar ou excluir dados sensíveis armazenados no sistema, incluindo informações pessoais dos usuários e dados críticos da aplicação.
- Com acesso administrativo, o atacante pode potencialmente modificar configurações críticas, instalar backdoors, e explorar outras vulnerabilidades na aplicação.

<a id="ancora1">> </a>
<h3>Prevenção e Correção</h3>

É essencial implementar práticas de desenvolvimento seguro e configurar corretamente o sistema para evitar que dados maliciosos possam ser inseridos e explorados como comandos SQL.

- Sempre valide e filtre todas as entradas de dados recebidas do usuário antes de usá-las em consultas SQL. Isso inclui campos de formulário, parâmetros de URL, cookies, etc.
- Realizar a sanitização dos dados utilizando uma API segura, como por exemplo o **Utilização de Prepared Statements (Declarações Preparadas)**: para separar os dados dos comandos SQL, impedindo assim a execução maliciosa de código SQL inserido.
- **Não realizar concatenação de strings.**
- **Usar ORM (Object-Relational Mapping):** evitar diretamente o uso de SQL bruto, automatizando a geração de consultas SQL seguras e prevenindo vulnerabilidades de injeção.
- Usar listas positivas(parâmetros permitidos) para validar os parâmetros que estiver na lista.
- **Implementar Princípio do Menor Privilégio**: Configure permissões de banco de dados e acesso de usuário de forma que apenas os privilégios mínimos necessários para realizar operações sejam concedidos. Evite usar contas de usuário com privilégios de administrador para operações rotineiras.
- Escapar todas as entradas fornecidas pelo o usuário.
- Limitar os resultados do retorno da comunicação.
  [Topo](#ancora)

<h2>3. Falha de Autenticação - Senha fraca</h2>

Ao explorar a vulnerabilidade de SQL Injection para acessar a conta de administrador, foi possível interceptar a comunicação e obter um token de Autenticação utilizando a ferramenta Burp Suite, realizando a intercepação do token Autenticação retornado após o login.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/sql-injection-burp-token.png" width="50%">
  </div>
</div>

O token foi decodificado de Base64 usando o **Decoder do Burp Suite**, revelando os dados do token e o hash da senha.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/sql-injection-password-hash.png" width="50%">
  </div>
</div>

O hash extraído do token foi salvo em um arquivo denominado hash_test.txt.
Utilizando a ferramenta John the Ripper para comparar o hash foi possível obter a senha do administrador: **admin123**

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e31ae14cb3f2baad80c33d9b417a836cfda088de/imagens/john-hash.png" width="50%">
  </div>
</div>

Com a senha obtida, foi realizado o login com as credenciais de administrador, confirmando a fraqueza da senha.

<h3>Prevenção e Correção</h3>

- Implementar políticas de senha fortes com um mínimo de caracteres, usando uma combinação de caracteres especiais, letras maiúsculas, letras minúsculas. Pois senhas menores que 8 caracteres são consideradas fracas.
- Exigir MFA (usar Authenticator Microsoft ou Google)
- Verifique as listas de vazamentos de senha e bloqueio o usos de senhas já comprometidas.
- Implementar limite de tentativas de login, por exemplo após 3 tentativas falhas, bloquear por 10 minutos, ou melhor, implementar de forma exponencial, sobrando o tempo para novas tentativas.
- Auxiliar os usuários a criarem a senha forte.
- Armazenar senhas usando algorítimos de criptografia forte.
- Notificar os usuários caso haja alteração em algum fator de autenticação.
- Não usar tokens e sessão como parâmetros na URL ou em mensagens de erro.
- Implementar mecanismos de recuperação de senha de forma segura, evitar notificações push via SMS.
- Implementar autenticação por IP.
- Logar todos os acesso de forma segura e revisar todas as falhas.
- Usar autenticação sem senha como SSO Logon.
- Permitir o gerecimento de senhas pelo usuário.

<h2> 4. Falha de Criptografia</h2>
Foi identificada uma falha crítica relacionada à criptografia. A análise do hash no token de Autenticação revelou que a aplicação utiliza a função de hash obsoleta MD5 para proteger senhas e outras informações sensíveis. Esta descoberta foi confirmada com o uso da ferramenta **HashIdentifier**, que identificou o tipo de hash utilizado.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3-pentest_servidor_aplicacao_web/blob/727d722389fdd0f6c5a35627ef86a231dd88a3e9/imagens/hash-identifier.png" width="50%">
  </div>
</div>

Confirmando que a aplicação usa função de hash obsoleta MD5. 

<h3>Impacto Potencial</h3>

- Exposição de dados confidenciais;
- Vulnerável a ataques de força bruta;
- Comprometimento do sistema;
- Perda da integridade dos dados.
  

<h3>Prevenção e Correção</h3>

- Evite funções criptográficas obsoletas e esquemas de preenchimento, como MD5, usar Argon2, bcrypt ou PBKDF2;
- Criptografar de forma segura os dados conficenciais em repouso e em trânsito;
- Não armaze dados sensíveis sem necessidade;
- Usar somente protocolos seguros e atualizados para tranportar dados como TLS;
- Use funções de hash com salt, tornando as senhas mais seguras;
- Verifique a adequação de todas as configurações de segurança e criptografia.
- Conscientizar sobre a importância de criptografia forte;

<h2>5. Falha de Tratamento de Erros - Erro handling</h2>

Ao tentar acessar vários caminhos de diretórios, foram retornados erros HTTP 500 (Erro Interno do Servidor). Esse erro expõe informações adicionais sobre os caminhos de arquivos e a estrutura da aplicação.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/e908922dbeeaaa77e5522cef5532ea18c6fc5f9e/imagens/error-handling.png" width="50%">
  </div>
</div>


<h3>Impacto potencial</h3>

Mensagens de erro detalhadas podem revelar informações sobre a estrutura interna da aplicação, incluindo caminhos de arquivos e configurações, que podem ser usadas para planejar ataques adicionais.
Exposição de informações sensíveis pode comprometer a segurança da aplicação, tornando mais fácil para um atacante encontrar e explorar fraquezas.

<h3>Prevenção e Correção</h3>

- Realizar o tratamento adequado de erros.
- **Registrar os erros, mas evite ser excessivamente detalhado nos logs para prevenir a exposição de informações sensíveis;**
- Garantir que os logs de alta qualidade estão protegidos pois contém dados sensíveis.
- **Tornar as mensagens de Erro amigáveis,** úteis e compreensíveis para os usuários sem revelar informações técnicas sensíveis.
- **Realizar a validação de entradas** e saídas. Sanitizar entradas do usuário para evitar erros e vulnerabilidades.
- Oferecer opções de recuperação ou caminhos alternativos quando ocorrer um error.


<h2>6. Força Bruta - Bypass de CAPTCHA</h2>

Foi identificado um problema de segurança relacionado ao CAPTCHA implementado na aplicação. A falha foi explorada nas seguintes rotas:

- **Rota para Administração**: `http://localhost:3000/#/administration`
    
    Foi possível deletar todos os comentários de feedback sem restrições adequadas.


<div align="center">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
        <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/ec0f84e552f2c6620939297b1fad8edebf964b48/imagens/apagando-os-comentariospng.png" style="display: inline-block; width: 45%; margin-right: 10px;">
    </div>
</div>

    
- **Rota de Contato**: `http://localhost:3000/#/contact`
    
    Na funcionalidade de registro de feedback, é necessário resolver um CAPTCHA de equação.
    <div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/ec0f84e552f2c6620939297b1fad8edebf964b48/imagens/testando-captcha-brute-force.png" width="80%">
  </div>
</div>

Assim, o CAPTCHA foi resolvido corretamente uma vez, permitindo o registro de um feedback.

Utilizando a ferramenta Burp Suite, interceptando a comunicação foi possível observar que era possível enviar várias requisições com os mesmos valores de entrada, sem a necessidade de resolver o CAPTCHA novamente. 

<div align="center">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/6a075d41c263444e4e9a90575a7cc89003858a2d/imagens/captcha-reapt-succes.png" style="display: inline-block; width: 45%; margin-right: 10px;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/6a075d41c263444e4e9a90575a7cc89003858a2d/imagens/captcha-reapt-succes2.png" style="display: inline-block; width: 45%; margin-right: 10px;">
  </div>
</div>

Usando **Burp Suite Intruder** foi automatizado o envio de requisições. Foram feitas 30 requisições repetidas ao sistema para testar a robustez do CAPTCHA e confirmar a ausência de verificação adicional.

<div align="center">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
     <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/6a075d41c263444e4e9a90575a7cc89003858a2d/imagens/baypass-captch-feedback-intrunder.png"" style="display: inline-block; width: 45%; margin-right: 10px;">
 <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/6a075d41c263444e4e9a90575a7cc89003858a2d/imagens/baypass-captch-feedback-intrunder-1.png" style="display: inline-block; width: 45%; margin-right: 10px;">
    </div>
</div>

Voltando à sessão administrador é possível notar que todos os 30 feedbacks foram registrados:

<div align="center">
  <div style="display: flex; flex-direction: column; align-items: center; gap: 10px;">
     <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/6a075d41c263444e4e9a90575a7cc89003858a2d/imagens/bypass-captcha.png" style="display: inline-block; width: 45%; margin-right: 10px;">
    </div>
</div>

<h3>Impacto potencial</h3>

O bypass do CAPTCHA e a capacidade de realizar força bruta através do envio automatizado de requisições podem ter os seguintes impactos negativos:

A falha em proteger o CAPTCHA adequadamente pode indicar vulnerabilidades mais amplas, possibilitando ataques automatizados e comprometendo a segurança geral da aplicação.
Impacto na Experiência do Usuário:

A capacidade de abusar da funcionalidade de feedback pode afetar negativamente a experiência do usuário e a confiabilidade da aplicação.

<h3>Prevenção e Correção</h3>

- Garanta que o CAPTCHA seja validado corretamente em cada solicitação. O sistema deve exigir uma nova resolução de CAPTCHA para cada tentativa de envio, não permitindo a reutilização dos mesmos valores.
- Estabeleça limites de tempo e taxa para o envio de feedback e outras ações, para prevenir abusos e minimizar o impacto de tentativas automatizadas.
- Monitore e registre as tentativas de envio e outras ações relacionadas para detectar padrões de comportamento suspeitos e responder rapidamente a possíveis abusos.
- Utilize CAPTCHAs mais robustos e complexos, que sejam menos suscetíveis a ataques automatizados e manipulação.

<h2> 7. DOM XSS</h2>

Durante a análise de segurança da página inicial da aplicação, foi identificado um problema de DOM-based Cross-Site Scripting (DOM XSS). A vulnerabilidade foi explorada no campo de pesquisa, que aparentemente estava funcionando conforme o esperado.
Foi injetado o seguinte código malicioso no campo de pesquisa: 

```
<iframe src="javascript:alert(`Testando xss`)">

```
A execução do código resultou na exibição de um alerta com a mensagem Testando xss, confirmando a presença da vulnerabilidade DOM XSS na aplicação.

<div align="center">
  <div style="display: flex; flex-direction: row;">
   <img src="https://github.com/biancagomess/projeto_3_Pentest_Servidor_Aplicacoes_Web/blob/3544d064450e31e838bab45a91c6681856e77f8e/imagens/dom-xss.png" width="50%">
  </div>
</div>

<h3>Impacto potencial</h3>

- Um atacante pode injetar scripts maliciosos que serão executados no contexto do navegador do usuário, permitindo a execução de código arbitrário.
- Scripts maliciosos podem ser utilizados para roubar dados sensíveis armazenados no navegador, como cookies, tokens de autenticação, e informações pessoais do usuário.
- Um atacante pode manipular ou roubar a sessão do usuário, levando a um comprometimento da conta e acesso não autorizado a funcionalidades e aos dados.
- Prejudicar a reputação e integridade.

<h3>Prevenção e Correção</h3>

- Implementar Políticas de Segurança de Conteúdo (CSP) para restringir a execução de scripts não autorizados e reduzir a superfície de ataque para XSS.
- Escapar as saídas ao incorporar dados dinâmicos no HTML ou em qualquer outro contexto onde o código possa ser executado.
- Utilizar funções de escapamento adequadas. 
- Realizar revisões regulares de segurança e os testes de penetração para identificar e corrigir vulnerabilidades de XSS e outras falhas de segurança.
- Conscientizar o time de dev sobre práticas seguras de codificação e a importância de proteger a aplicação contra ataques XSS.


